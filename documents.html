<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PhysioCare - Documents</title>
    <style>
        .upload-zone {
            border: 2px dashed #37A7C4;
            padding: 20px;
            text-align: center;
            border-radius: 10px;
            cursor: pointer;
        }
        .document-item {
            display: flex;
            justify-content: space-between;
            background: #f9f9f9;
            padding: 10px;
            margin-bottom: 5px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .error-message {
            color: red;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="upload-zone" id="dropZone">Déposez vos fichiers ici (images ou PDF)</div>
    <input type="file" id="fileInput" multiple accept="image/*,.pdf" style="display: none;">
    <div id="documentList"></div>
    <div class="error-message" id="errorMessage"></div>

    <script>
        const MAX_FILE_SIZE = 10 * 1024 * 1024; // 10 Mo
        const MAX_TOTAL_SIZE = 50 * 1024 * 1024; // 50 Mo
        const dropZone = document.getElementById('dropZone');
        const fileInput = document.getElementById('fileInput');
        const documentList = document.getElementById('documentList');
        const errorMessage = document.getElementById('errorMessage');

        dropZone.addEventListener('click', () => fileInput.click());
        dropZone.addEventListener('drop', (e) => {
            e.preventDefault();
            handleFiles(e.dataTransfer.files);
        });
        dropZone.addEventListener('dragover', (e) => e.preventDefault());
        fileInput.addEventListener('change', () => handleFiles(fileInput.files));

        function handleFiles(files) {
            let totalSize = Array.from(documentList.children).reduce((size, item) => {
                return size + parseInt(item.dataset.fileSize || '0', 10);
            }, 0);

            for (const file of files) {
                if (file.size > MAX_FILE_SIZE) {
                    showError(`${file.name} dépasse la limite de 10 Mo.`);
                    continue;
                }
                if (totalSize + file.size > MAX_TOTAL_SIZE) {
                    showError(`Taille totale des fichiers dépasse 50 Mo.`);
                    break;
                }

                const reader = new FileReader();
                reader.onload = () => addDocument(file.name, file.size, reader.result, file.type);
                reader.readAsDataURL(file);
                totalSize += file.size;
            }
        }

        function addDocument(name, size, base64, type) {
            const item = document.createElement('div');
            item.className = 'document-item';
            item.dataset.fileSize = size;

            item.innerHTML = `
                <span>${name} (${(size / (1024 * 1024)).toFixed(2)} Mo - ${type.includes('pdf') ? 'PDF' : 'Image'})</span>
                <button onclick="this.parentElement.remove()">Supprimer</button>
            `;

            documentList.appendChild(item);
        }

        function showError(message) {
            errorMessage.textContent = message;
            setTimeout(() => (errorMessage.textContent = ''), 5000);
        }
    </script>
</body>
</html>
